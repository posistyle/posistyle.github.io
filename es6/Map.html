<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Map | 日常总结</title>
    <meta name="description" content="Just playing around">
    <meta name="generator" content="VuePress 1.3.1">
    
    
    <link rel="preload" href="/assets/css/0.styles.45955094.css" as="style"><link rel="preload" href="/assets/js/app.921c3b06.js" as="script"><link rel="preload" href="/assets/js/2.4f9d6ee2.js" as="script"><link rel="preload" href="/assets/js/8.8191e6f7.js" as="script"><link rel="prefetch" href="/assets/js/10.4acd6e3b.js"><link rel="prefetch" href="/assets/js/11.72fb5b16.js"><link rel="prefetch" href="/assets/js/12.40445b50.js"><link rel="prefetch" href="/assets/js/13.7be708d2.js"><link rel="prefetch" href="/assets/js/14.e71aaf53.js"><link rel="prefetch" href="/assets/js/15.3d6ea30c.js"><link rel="prefetch" href="/assets/js/16.1c59bb6e.js"><link rel="prefetch" href="/assets/js/17.13321de6.js"><link rel="prefetch" href="/assets/js/18.af98cefa.js"><link rel="prefetch" href="/assets/js/19.d8223939.js"><link rel="prefetch" href="/assets/js/20.89828e5b.js"><link rel="prefetch" href="/assets/js/21.1cc1b4af.js"><link rel="prefetch" href="/assets/js/3.52ba4223.js"><link rel="prefetch" href="/assets/js/4.3ce938be.js"><link rel="prefetch" href="/assets/js/5.0886b92c.js"><link rel="prefetch" href="/assets/js/6.567e7358.js"><link rel="prefetch" href="/assets/js/7.ffba3dae.js"><link rel="prefetch" href="/assets/js/9.49f815c4.js">
    <link rel="stylesheet" href="/assets/css/0.styles.45955094.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">日常总结</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Es6</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/es6/Set.html" class="sidebar-link">Set和Weakset</a></li><li><a href="/es6/Map.html" class="active sidebar-link">Map和WeakMap</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/es6/Map.html#map" class="sidebar-link">Map</a></li><li class="sidebar-sub-header"><a href="/es6/Map.html#注意点" class="sidebar-link">注意点</a></li><li class="sidebar-sub-header"><a href="/es6/Map.html#其他数据结构的互相转换" class="sidebar-link">其他数据结构的互相转换</a></li><li class="sidebar-sub-header"><a href="/es6/Map.html#weakmap" class="sidebar-link">WeakMap</a></li></ul></li><li><a href="/es6/class.html" class="sidebar-link">class</a></li><li><a href="/es6/proxy.html" class="sidebar-link">Proxy</a></li><li><a href="/es6/Reflect.html" class="sidebar-link">Reflect</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>js知识点</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>工具使用</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>node</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>http</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="map"><a href="#map" class="header-anchor">#</a> Map</h2> <h3 id="类似与对象，也是键值对的集合，但是-键-的范围不限于字符串"><a href="#类似与对象，也是键值对的集合，但是-键-的范围不限于字符串" class="header-anchor">#</a> --&gt;类似与对象，也是键值对的集合，但是‘键’的范围不限于字符串</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> m <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//Map本身是一个构造函数，接受一个数组作为参数,或者任何具有Iterator接口，且每个成员都是双元素的数组的数据结构</span>
</code></pre></div><h3 id="map实例的属性和操作方法"><a href="#map实例的属性和操作方法" class="header-anchor">#</a> Map实例的属性和操作方法</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">**</span> 属性 size
</code></pre></div><div class="language-js extra-class"><pre class="language-js"><code><span class="token operator">**</span> 方法
  <span class="token keyword">set</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span> <span class="token comment">//set方法设置键名key对应的键值为value，然后返回整个 Map 结构</span>
  <span class="token keyword">get</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token comment">//方法读取key对应的键值，如果找不到key，返回undefined</span>
  <span class="token function">has</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token comment">//表示是否包含某一个值，返回一个布尔值</span>
  <span class="token keyword">delete</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token comment">//删除某个值，返回一个布尔值</span>
  <span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">//清楚所有成员，没有返回值</span>

  <span class="token operator">*</span>遍历方法 （Map 的遍历顺序就是插入顺序）
  <span class="token class-name">Map</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token comment">//返回键名的遍历器</span>
  <span class="token class-name">Map</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token comment">//返回键值的遍利器</span>
  <span class="token class-name">Map</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token comment">//返回所有成员的遍历器</span>
  <span class="token class-name">Map</span><span class="token punctuation">.</span>prototype<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token comment">//遍历 Map 的所有成员</span>

</code></pre></div><h2 id="注意点"><a href="#注意点" class="header-anchor">#</a> 注意点</h2> <p>1.对同一个值多次赋值，后面的值覆盖前面的值</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> m2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
m2<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'aaa'</span><span class="token punctuation">)</span>
m2<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">'bbb'</span><span class="token punctuation">)</span>
m2<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment">// 'bbb'</span>
</code></pre></div><p>2.读取一个未知的键，返回undefined</p> <div class="language-js extra-class"><pre class="language-js"><code>  m2<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token comment">//undefined </span>
</code></pre></div><p>3.只有对同一个对象的引用，Map 结构才将其视为同一个键</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">const</span> m3 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  m3<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>
  m3<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// undefined</span>

  <span class="token keyword">let</span> k1 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span>
  <span class="token keyword">let</span> k2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'b'</span><span class="token punctuation">]</span>
  m3<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>k1<span class="token punctuation">,</span> <span class="token number">111</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>k2<span class="token punctuation">,</span> <span class="token number">222</span><span class="token punctuation">)</span>
  m3<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>k1<span class="token punctuation">)</span><span class="token punctuation">,</span> m3<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>k2<span class="token punctuation">)</span> <span class="token comment">// 111 222</span>

  <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'c'</span><span class="token punctuation">]</span>
  <span class="token keyword">let</span> arr1 <span class="token operator">=</span> arr
  m3<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>arr<span class="token punctuation">,</span> <span class="token number">333</span><span class="token punctuation">)</span>
  m3<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>arr1<span class="token punctuation">,</span> <span class="token number">444</span><span class="token punctuation">)</span>
  m3<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr<span class="token punctuation">)</span><span class="token punctuation">;</span> m3<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>arr1<span class="token punctuation">)</span> <span class="token comment">// 444 444</span>
</code></pre></div><p>4.如果 Map 的键是一个简单类型的值（数字、字符串、布尔值），则只要两个值严格相等，Map 将其视为一个键</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token keyword">let</span> m4 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  m4<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">123</span><span class="token punctuation">)</span>
  m4<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment">// 123</span>

  m4<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> 
  m4<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">NaN</span><span class="token punctuation">)</span> <span class="token comment">// 1</span>
</code></pre></div><hr> <h3 id="遍历方法-需要特别注意的是，map-的遍历顺序就是插入顺序"><a href="#遍历方法-需要特别注意的是，map-的遍历顺序就是插入顺序" class="header-anchor">#</a> 遍历方法 (需要特别注意的是，Map 的遍历顺序就是插入顺序)</h3> <p>1.Map 结构原生提供三个遍历器生成函数和一个遍历方法</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">'F'</span><span class="token punctuation">,</span> <span class="token string">'no'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string">'T'</span><span class="token punctuation">,</span> <span class="token string">'yes'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">of</span> map<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token comment">// 'F' 'T'</span>
<span class="token punctuation">}</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> val <span class="token keyword">of</span> map<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>val<span class="token punctuation">)</span> <span class="token comment">// 'no' 'yes'</span>
<span class="token punctuation">}</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> item <span class="token keyword">of</span> map<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>item<span class="token punctuation">,</span> Array<span class="token punctuation">.</span><span class="token function">isArray</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// [ 'F', 'no' ] [ 'T', 'yes' ]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>2.使用filter方法，实现Map的遍历和过滤</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> map0 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'a'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token string">'b'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> map1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>map0<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">[</span>k<span class="token punctuation">,</span>v<span class="token punctuation">]</span><span class="token punctuation">,</span> index<span class="token punctuation">,</span> key</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span> k <span class="token operator">&lt;</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">//{ 1 =&gt; 'a', 2 =&gt; 'b' }</span>
map0<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">value<span class="token punctuation">,</span> key<span class="token punctuation">,</span> map</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;Key: %s, Value: %s&quot;</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><hr> <h2 id="其他数据结构的互相转换"><a href="#其他数据结构的互相转换" class="header-anchor">#</a> 其他数据结构的互相转换</h2> <p>1.Map转化为数组</p> <div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>map0<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// [ [ 1, 'a' ], [ 2, 'b' ], [ 3, 'c' ] ]</span>
</code></pre></div><p>2.数组转为Map</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> arr2 <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>foo<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'abc'</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span>
<span class="token keyword">var</span> arrToMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span>arr2<span class="token punctuation">)</span> <span class="token comment">//{ true =&gt; 7, { foo: 3 } =&gt; [ 'abc' ] }</span>
</code></pre></div><p>3.Map转对象(如果所有 Map 的键都是字符串，它可以无损地转为对象)</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> myMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'yes'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span>
<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'no'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> obj <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span>
<span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">var</span> <span class="token punctuation">[</span>k<span class="token punctuation">,</span> v<span class="token punctuation">]</span> <span class="token keyword">of</span> myMap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  obj<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> v
<span class="token punctuation">}</span> 
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj<span class="token punctuation">,</span> obj<span class="token punctuation">.</span>_prot_<span class="token punctuation">)</span> <span class="token comment">// { yes: true, no: false }, undefined</span>
</code></pre></div><p>4.对象转为Map</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj1 <span class="token operator">=</span> <span class="token punctuation">{</span>yes<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> no<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span>
<span class="token keyword">function</span> <span class="token function">objToMap</span><span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> objToMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> k <span class="token keyword">of</span> Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    objToMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> obj<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> objToMap
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">objToMap</span><span class="token punctuation">(</span>obj1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// { 'yes' =&gt; true, 'no' =&gt; false }</span>
</code></pre></div><p>5.Map转为JSON</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">//1.Map 的键名都是字符串转为对象 JSON。</span>
  <span class="token keyword">let</span> m5 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'yes'</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string">'no'</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">function</span> <span class="token function">strMaptoJson</span> <span class="token punctuation">(</span><span class="token parameter">strMap</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token function">strMaptoObj</span><span class="token punctuation">(</span>strMap<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token comment">//2.Map 的键名有非字符串，这时可以选择转为数组 JSON</span>
  <span class="token keyword">let</span> m6 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">{</span>foo<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">'abc'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">...</span>m6<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>6.JSON转为Map</p> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token comment">//1.所有键名都是字符串</span>
  <span class="token keyword">let</span> JSONStr <span class="token operator">=</span> <span class="token string">'{&quot;yes&quot;: true, &quot;no&quot;: false}'</span>
  <span class="token keyword">let</span> JSONObj <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>JSONStr<span class="token punctuation">)</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">objToMap</span><span class="token punctuation">(</span>JSONObj<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token comment">//2.整个 JSON 就是一个数组，且每个数组成员本身，又是一个有两个成员的数组。这时，它可以一一对应地转为 Map</span>
  <span class="token keyword">let</span> JSONStr1 <span class="token operator">=</span> <span class="token string">'[[true,7],[{&quot;foo&quot;:3},[&quot;abc&quot;]]]'</span>
  <span class="token keyword">let</span> JSONArr <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>JSONStr1<span class="token punctuation">)</span>
  <span class="token keyword">let</span> m7 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Map</span><span class="token punctuation">(</span>JSONArr<span class="token punctuation">)</span> <span class="token comment">//{ true =&gt; 7, { foo: 3 } =&gt; [ 'abc' ] }</span>
</code></pre></div><h2 id="weakmap"><a href="#weakmap" class="header-anchor">#</a> WeakMap</h2> <h3 id="结构与map结构类似"><a href="#结构与map结构类似" class="header-anchor">#</a> --&gt; 结构与Map结构类似</h3> <h3 id="与map的区别"><a href="#与map的区别" class="header-anchor">#</a> 与Map的区别</h3> <p>1.WeakMap只接受对象作为键名（null除外），不接受其他类型的值作为键名</p> <p>2.weakMap的键名所指向的对象，不计入垃圾回收机制</p> <h3 id="weakmap的语法只有四个方法可用-没有遍历操作和size属性"><a href="#weakmap的语法只有四个方法可用-没有遍历操作和size属性" class="header-anchor">#</a> WeakMap的语法只有四个方法可用,没有遍历操作和size属性</h3> <div class="language-js extra-class"><pre class="language-js"><code>  <span class="token number">1.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token number">2.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token number">3.</span><span class="token function">has</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token number">4.</span><span class="token function">delete</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><h3 id="weakmap用途"><a href="#weakmap用途" class="header-anchor">#</a> WeakMap用途</h3> <h4 id="_1-应用的典型场合就是-dom-节点作为键名"><a href="#_1-应用的典型场合就是-dom-节点作为键名" class="header-anchor">#</a> 1.应用的典型场合就是 DOM 节点作为键名</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//1.一旦这个 DOM 节点删除，该状态就会自动消失，不存在内存泄漏风险。</span>
<span class="token keyword">let</span> myElemnet <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'logo'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> myWeakMap <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
myWeakMap<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>myElemnet<span class="token punctuation">,</span> <span class="token punctuation">{</span>timesClicked<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">}</span><span class="token punctuation">)</span>
myElemnet<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">'click'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
  <span class="token keyword">let</span> logoData <span class="token operator">=</span> myWeakMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>myElemnet<span class="token punctuation">)</span>
  logoData<span class="token punctuation">.</span>timesClicked<span class="token operator">++</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span>
</code></pre></div><h4 id="_2-另一个用处是部署私有属性。"><a href="#_2-另一个用处是部署私有属性。" class="header-anchor">#</a> 2.另一个用处是部署私有属性。</h4> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//2.Countdown类的两个内部属性_counter和_action，是实例的弱引用，所以如果删除实例，它们也就随之消失，不会造成内存泄漏。</span>
<span class="token keyword">const</span> _counter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> _action <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WeakMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">Countdown</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span> <span class="token punctuation">(</span><span class="token parameter">counter<span class="token punctuation">,</span> action</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
    _counter<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> counter<span class="token punctuation">)</span>
    _action<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> action<span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token function">dec</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> counter <span class="token operator">=</span> _counter<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>counter<span class="token punctuation">)</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>counter <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">return</span>
    counter<span class="token operator">--</span>
    _counter<span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> counter<span class="token punctuation">)</span> 
    <span class="token keyword">if</span><span class="token punctuation">(</span>counter <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      _action<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> c <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Countdown</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'DONE'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
c<span class="token punctuation">.</span><span class="token function">dec</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
c<span class="token punctuation">.</span><span class="token function">dec</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/es6/Set.html" class="prev">
        Set和Weakset
      </a></span> <span class="next"><a href="/es6/class.html">
        class
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.921c3b06.js" defer></script><script src="/assets/js/2.4f9d6ee2.js" defer></script><script src="/assets/js/8.8191e6f7.js" defer></script>
  </body>
</html>
